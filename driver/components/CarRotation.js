import { useNavigation } from "@react-navigation/native";
import {
  Canvas,
  LinearGradient,
  Fill,
  // Use this function instead of interpolateColor from Reanimated
  interpolateColors,
  vec,
  Text,  useFont,
  Group, Path,
  Rect,
  Image, useImage
} from "@shopify/react-native-skia";
import { useEffect } from "react";
import {  useWindowDimensions } from "react-native";
import {
  useDerivedValue,
  useSharedValue,
  withRepeat,
  withTiming,
} from "react-native-reanimated";


const startColors = [
  "rgba(255,192,0,1)",  // #FFC000 in solid color
  "rgb(255, 210, 75)", // Light orange in solid color
  "rgba(0,0,0,1)",      // Black in solid color
];

const endColors = [
  "rgba(255,217,102,0.8)", // Light orange with transparency
  "rgba(255, 191, 0, 0.87)",   // #FFC000 with transparency
  "rgba(0,0,0,0.8)",       // Black with transparency
];
const CarRotation = () => {
  const { width, height } = useWindowDimensions();
  const colorsIndex = useSharedValue(0);
  const fontSize = 32;
  const font = useFont( fontSize);
  const pathWidth = 115; // Roughly from 0 to 115 in the path data
  const pathHeight = 38; // Roughly from 8 to 46 in the path data
   const navigation = useNavigation()

  // Calculate center position
  const centerX = (width - pathWidth) / 2;
  const centerY = (height - pathHeight) / 2;
  
  useEffect(() => {
    colorsIndex.value = withRepeat(
      withTiming(startColors.length - 1, {
        duration: 6000,
      }),
      -1,
      false
    );

     // Navigate after 5 seconds
     const timer = setTimeout(() => {
      navigation.navigate('Get Started');
    }, 5950);

    // Cleanup timeout if component unmounts
    return () => clearTimeout(timer);
  }, []);
  const gradientColors = useDerivedValue(() => {
    return [
      interpolateColors(colorsIndex.value, [0, 1, 2, 3], startColors),
      interpolateColors(colorsIndex.value, [0, 1, 2, 3], endColors),
    ];
  });

  // Add this to control path opacity
  const pathOpacity = useDerivedValue(() => {
    // Show path when colorsIndex is near 2 (black color)
    return Math.max(0, Math.min(1, colorsIndex.value - 1.75));

    // Path dimensions (approximately based on the path coordinates)
 
  });
  return (
    <Canvas style={{ flex: 1, width: width }}>
        <Fill>
          <LinearGradient
              start={vec(0, 0)}
              end={vec(width, height)}
              colors={gradientColors}
            />

        </Fill>
        <Group opacity={pathOpacity} transform={[{ translateX: centerX }, { translateY: centerY }]}>
        <Path
          path="M6.60 9.65L13.80 10.05Q18.60 10.05 20.70 8.90Q21 8.70 21.23 8.70Q21.45 8.70 21.45 9.40Q21.45 10.10 20.60 11.70Q19.35 14.15 17 14.15L14.25 14.10Q13.85 14.10 13.75 14.55Q13.40 21.90 13.40 30.42Q13.40 38.95 14.10 43.25L14.10 43.50Q14.10 44.75 11.73 45.50Q9.35 46.25 7.25 46.25Q6.25 46.25 6.25 45.70Q6.25 45.55 6.40 45Q6.95 43.90 7.38 34.35Q7.80 24.80 7.80 19.95L7.70 14.50Q7.70 14.20 7.40 14.15Q6.35 13.95 5 13.95Q2.30 13.95 1.00 15.05Q0.65 15.30 0.33 15.30Q0 15.30 0 14.90Q0 14.30 0.63 13.25Q1.25 12.20 1.95 11.45Q3.65 9.65 6.60 9.65ZM35.85 30.25L35.75 36.65Q35.75 43.30 37.20 44.65Q37.40 44.85 37.40 45.10Q37.40 45.85 34.18 45.85Q30.95 45.85 30.75 43.95Q30.70 43.50 30.70 42.10L30.90 34.10Q30.90 33.75 30.50 33.75Q28.10 33.75 26 35.10Q23.90 36.45 23.90 38.55Q23.90 39.65 24.50 40.40Q25.10 41.15 25.98 41.15Q26.85 41.15 27.43 40.80Q28.00 40.45 28.10 40.40Q28.95 40.50 28.95 42.17Q28.95 43.85 27.40 44.88Q25.85 45.90 24.15 45.90Q22.45 45.90 21.23 45.30Q20.00 44.70 19.45 43.95Q18.90 43.20 18.55 42.25Q18.20 41.10 18.20 40.25Q18.20 36.75 20.40 34.65Q22.60 32.55 26.05 31.65Q30.60 30.75 30.80 30Q30.95 29.45 30.95 28.15Q30.95 25.50 28.25 25.50Q27.10 25.50 26.20 26.22Q25.30 26.95 25.30 28.05L25.60 29.25Q25.50 30.10 23.80 30.25L23.25 30.30Q21.75 30.30 20.88 29.55Q20.00 28.80 20.00 27.55Q20.00 26.75 20.53 25.77Q21.05 24.80 21.85 24.20Q22.65 23.60 24.33 23.13Q26 22.65 27.55 22.65Q29.10 22.65 29.95 22.75Q30.80 22.85 32.28 23.22Q33.75 23.60 34.73 24.65Q35.70 25.70 35.78 26.88Q35.85 28.05 35.85 30.25ZM38.40 40.35L39.40 40.50Q42.35 40.50 45.30 35.45Q45.45 35.20 45.70 34.85Q43.50 30.80 41.88 28.40Q40.25 26 39.70 25.65L39.20 25.25Q38.50 24.95 38.50 24.50Q38.50 23.85 40.33 23.10Q42.15 22.35 43.75 22.25Q44.60 22.20 45.35 23.50Q46.75 25.55 48.75 29.75L48.75 29.85Q51.10 25.85 51.75 24.20Q51.75 23.45 53.00 23.05Q54.25 22.65 56.10 22.65Q57.95 22.65 57.95 23.25Q57.95 23.50 57.50 23.80Q57.20 23.95 56.63 24.40Q56.05 24.85 54.20 27.02Q52.35 29.20 50.45 32.35Q50.35 32.50 50.30 32.65Q53.20 37.90 53.75 38.67Q54.30 39.45 54.63 39.95Q54.95 40.45 55.93 41.40Q56.90 42.35 57.78 42.60Q58.65 42.85 58.65 43.30Q58.65 44 56.85 44.98Q55.05 45.95 53.50 45.95Q52.40 45.95 51.80 45.20Q50.75 43.95 47.20 37.75Q44.10 42.90 43.50 43.73Q42.90 44.55 42.00 45.20Q41.10 45.85 40.03 45.85Q38.95 45.85 38.28 45.15Q37.60 44.45 37.50 43.75L37.40 43.05Q37.40 40.35 38.40 40.35ZM64.65 18.50L63.45 18.45Q62.10 18.45 61.70 19.10Q61.60 19.25 61.45 19.25Q60.80 19.25 60.80 17.02Q60.80 14.80 61.48 14.20Q62.15 13.60 63.83 13.60Q65.50 13.60 66.10 14.17Q66.70 14.75 66.70 16.10Q66.70 17.45 66.25 17.97Q65.80 18.50 64.65 18.50M60.65 43.75L61.20 32.10Q61.20 27.95 60.25 26.45Q59.95 25.95 59.55 25.70Q59.25 25.60 59.25 25.30Q59.25 24.40 61.80 23.55Q64.35 22.70 65.53 22.70Q66.70 22.70 66.75 23.30Q66.75 24.30 66.48 28.97Q66.20 33.65 66.20 38.80Q66.20 43.95 66.80 45.20Q66.95 45.45 66.95 45.70Q66.95 46.35 65.05 46.35Q63.15 46.35 61.15 45.35Q60.65 45.10 60.65 43.75ZM83 16.60Q79.05 21.55 77.30 26.50L77.35 26.50Q84.30 26.50 85.33 26.52Q86.35 26.55 86.45 26.45Q86.55 26.35 86.60 26.20Q85.75 20.05 85.25 17.82Q84.75 15.60 84.25 15.60Q83.75 15.60 83 16.60M78.55 40.15L79.65 39.95Q80.15 39.95 80.15 40.50Q80.15 42.25 79.45 43.45Q78.75 44.65 77.70 45.15Q76 46 74.80 46Q72.50 46 71.35 44.27Q70.20 42.55 70.20 39.08Q70.20 35.60 72.10 30.05L69.20 30.05Q68.65 30.05 68.65 29.50Q68.65 28.95 69.50 27.72Q70.35 26.50 71.30 26.50L73.55 26.50Q77.10 18.60 81.90 12.85Q83.15 11.35 84.97 10.05Q86.80 8.75 87.80 8.75Q88.80 8.75 89.30 9.65Q90.60 11.75 92.35 25Q92.95 30.70 94.42 36.77Q95.90 42.85 97.15 43.85Q97.45 44.05 97.45 44.35Q97.45 45.10 95.33 45.75Q93.20 46.40 92.08 46.40Q90.95 46.40 90.35 46.13Q89.75 45.85 89.60 45.55Q88.70 43.60 87.80 36.25L87.50 33.90Q87.30 31.55 87.10 30.35L86.75 30.10L76.30 30.05Q75.70 32.60 75.70 34.50Q75.70 36.40 75.83 37.27Q75.95 38.15 76.65 39.15Q77.35 40.15 78.55 40.15ZM113.90 31.85L114.10 33.60Q114.10 34.55 112.30 34.55Q108.65 34.55 108.65 31.80Q108.65 31.15 109 30Q109.35 28.85 109.35 28Q109.35 27.15 108.85 26.52Q108.35 25.90 107.40 25.90Q106.45 25.90 105.78 26.57Q105.10 27.25 104.95 27.95L104.75 28.65Q104.45 30.20 104.45 33.83Q104.45 37.45 104.55 39.52Q104.65 41.60 104.75 42.38Q104.85 43.15 104.85 43.30Q104.85 44.55 103.30 45.33Q101.75 46.10 100.20 46.10Q98.65 46.10 98.65 45.45L98.90 43.90Q99.60 39.55 99.60 32.55Q99.60 25.55 99.10 23.05Q99.10 22.45 100.15 22.45Q102.85 22.45 103.75 24.30Q103.80 24.50 103.93 24.50Q104.05 24.50 104.60 24.05Q106.25 22.70 108.50 22.70Q109.90 22.70 111.30 23.25Q114.15 24.40 114.15 28.05L113.90 31.85Z"
          color="white"
          style="fill"
        />
      </Group>
        
        
    </Canvas>
  );
};

export default  CarRotation;